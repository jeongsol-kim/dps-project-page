<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="description"
        content="Diffusion posterior sampling project page">
  <meta name="keywords" content="Diffusion models, Inverse problems, Posterior sampling">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>DPS: Diffusion Posterior Sampling for Noisy(Non-)linear Inverse Problems</title>

  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-PYVRSFMDRL"></script>
  <script>
    window.dataLayer = window.dataLayer || [];

    function gtag() {
      dataLayer.push(arguments);
    }

    gtag('js', new Date());

    gtag('config', 'G-PYVRSFMDRL');
  </script>

  <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro"
        rel="stylesheet">

  <link rel="stylesheet" href="./static/css/bulma.min.css">
  <link rel="stylesheet" href="./static/css/bulma-carousel.min.css">
  <link rel="stylesheet" href="./static/css/bulma-slider.min.css">
  <link rel="stylesheet" href="./static/css/fontawesome.all.min.css">
  <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  <link rel="stylesheet" href="./static/css/index.css">
  <link rel="icon" href="./static/images/favicon.svg">
  <link rel="stylesheet" href="https://unpkg.com/img-comparison-slider@7/dist/styles.css"/>
  

  <script defer src="https://unpkg.com/img-comparison-slider@7/dist/index.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script defer src="./static/js/fontawesome.all.min.js"></script>
  <script src="./static/js/bulma-carousel.min.js"></script>
  <script src="./static/js/bulma-slider.min.js"></script>
  <script src="./static/js/index.js"></script>
  <script src="./static/js/result_button.js"></script>
  <!-- For formula -->
  <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: { inlineMath: [['$$', '$$']], displayMath: [['$$$', '$$$']] }
    });
  </script>
  <script src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">

</script>
</head>
<body>

<nav class="navbar" role="navigation" aria-label="main navigation">
  <div class="navbar-brand">
    <a role="button" class="navbar-burger" aria-label="menu" aria-expanded="false">
      <span aria-hidden="true"></span>
      <span aria-hidden="true"></span>
      <span aria-hidden="true"></span>
    </a>
</nav>


<section class="hero">
  <div class="hero-body">
    <div class="container is-max-desktop">
      <div class="columns is-centered">
        <div class="column has-text-centered">
          <h1 class="title is-1 publication-title">DPS: Diffusion Posterior Sampling for Noisy(Non-)linear Inverse Problems</h1>
          <div class="is-size-5 publication-authors">
            <span class="author-block">
              <a href="https://hj-chung.com">Hyungjin Chung</a><sup>1</sup>,</span>
            <span class="author-block">
              <a href="https://bispl.weebly.com/members.html">Jeongsol Kim</a><sup>1</sup>,</span>
            <span class="author-block">
              <a href="https://michael-t-mccann.github.io/">Michael T. McCann</a><sup>2</sup>,
            </span>
            <span class="author-block">
              <a href="https://scholar.google.com/citations?user=AKo06isAAAAJ&hl=en">Marc L. Klasky</a><sup>1,2</sup>,
            </span>
            <span class="author-block">
              <a href="https://bispl.weebly.com/professor.html">Jong Chul Ye</a><sup>1</sup>,
            </span>
          </div>

          <div class="is-size-5 publication-authors">
            <span class="author-block"><sup>1</sup>Korea Advanced Institute of Science & Technology (KAIST),</span>
            <span class="author-block"><sup>2</sup>Los Alamos National Laboratory (LANL)</span>
          </div>

          <div class="column has-text-centered">
            <div class="publication-links">
              <!-- PDF Link. -->
              <span class="link-block">
                <a href=""
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fas fa-file-pdf"></i>
                  </span>
                  <span>Paper</span>
                </a>
              </span>
              <span class="link-block">
                <a href=""
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="ai ai-arxiv"></i>
                  </span>
                  <span>arXiv</span>
                </a>
              </span>
              <!-- Video Link. -->
              <!-- <span class="link-block">
                <a href="https://www.youtube.com/watch?v=MrKrnHhk8IA"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fab fa-youtube"></i>
                  </span>
                  <span>Video</span>
                </a>
              </span>
              <!-- Code Link. -->
              <span class="link-block">
                <a href=""
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fab fa-github"></i>
                  </span>
                  <span>Code (TBA)</span>
                  </a>
              </span>
              <!-- Dataset Link. -->
              <!-- <span class="link-block">
                <a href="https://github.com/google/nerfies/releases/tag/0.1"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="far fa-images"></i>
                  </span>
                  <span>Data</span>
                  </a>  -->
            </div>

          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<section class="hero teaser">
  <div class="container is-max-desktop">
    <div class="hero-body">
      <img id="teaser" height="100%" src="./static/images/cover.jpg" alt="">
      <!-- <video id="teaser" autoplay muted loop playsinline height="100%">
        <source src="https://homes.cs.washington.edu/~kpar/nerfies/videos/teaser.mp4"
                type="video/mp4">
      </video> -->
      <h2 class="subtitle has-text-centered">
        Diffusion Posterior Sampling (DPS) enables to solve inverse problems with noise.
      </h2>
    </div>
  </div>
</section>

<!-- <section class="hero is-light is-small super-resolution">
  <div class="hero-body">
    <div class="container">
      <h3 class="task-name"><b>Super-resolution Examples</b></h3>
      <div id="results-carousel gaussian" class="carousel results-carousel">        
        <div class="item">
          <img-comparison-slider>
            <img slot="first" src="static/images/results_approx/super_resolution/input/00000.png" width="256" height="256"/>
            <img slot="second" src="static/images/results_approx/super_resolution/recon/00000.png" width="256" height="256"/>
          </img-comparison-slider>
        </div>
        
        <div class="item">
          <img-comparison-slider>
            <img slot="first" src="static/images/results_approx/super_resolution/input/00003.png" width="256" height="256"/>
            <img slot="second" src="static/images/results_approx/super_resolution/recon/00003.png" />
          </img-comparison-slider>
        </div>

        <div class="item">
          <img-comparison-slider>
            <img slot="first" src="static/images/results_approx/super_resolution/input/00004.png" width="256" height="256"/>
            <img slot="second" src="static/images/results_approx/super_resolution/recon/00004.png" />
          </img-comparison-slider>
        </div>
        
        <div class="item">
          <img-comparison-slider>
            <img slot="first" src="static/images/results_approx/super_resolution/input/00005.png" width="256" height="256"/>
            <img slot="second" src="static/images/results_approx/super_resolution/recon/00005.png" />
          </img-comparison-slider>
        </div>
        
        <div class="item">
          <img-comparison-slider>
            <img slot="first" src="static/images/results_approx/super_resolution/input/00007.png" width="256" height="256"/>
            <img slot="second" src="static/images/results_approx/super_resolution/recon/00007.png" />
          </img-comparison-slider>
        </div>
      </div> 
    </div>
  </div>
</section>

<section class="hero is-light is-small motion-deblur">
  <div class="hero-body">
    <div class="container">
      <h3 class="task-name"><b>Motion-deblur Examples</b></h3>

      <div id="results-carousel" class="carousel results-carousel">

        <div class="item">
          <img-comparison-slider>
            <img slot="first" src="static/images/results/deblur/motion/ />
            <img slot="second" src="static/images/results/deblur/motion/recon/00000.png" />
          </img-comparison-slider>
        </div>
        
        <div class="item">
          <img-comparison-slider>
            <img slot="first" src="static/images/results_approx/motion_blur/input/00003.png" />
            <img slot="second" src="static/images/results_approx/motion_blur/recon/00003.png" />
          </img-comparison-slider>
        </div>
        
        <div class="item">
          <img-comparison-slider>
            <img slot="first" src="static/images/results_approx/motion_blur/input/00004.png" />
            <img slot="second" src="static/images/results_approx/motion_blur/recon/00004.png" />
          </img-comparison-slider>
        </div>
        
        <div class="item">
          <img-comparison-slider>
            <img slot="first" src="static/images/results_approx/motion_blur/input/00005.png" />
            <img slot="second" src="static/images/results_approx/motion_blur/recon/00005.png" />
        </img-comparison-slider>
        </div>
        
        <div class="item">
          <img-comparison-slider>
            <img slot="first" src="static/images/results_approx/motion_blur/input/00007.png" />
            <img slot="second" src="static/images/results_approx/motion_blur/recon/00007.png" />
          </img-comparison-slider>
        </div>

      </div> 
    </div>
  </div>
</section> -->

<section class="section">
  <div class="container is-max-desktop">
    <!-- Abstract. -->
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Abstract</h2>
        <div class="content has-text-justified">
          <p>
            Diffusion models have been recently used as generative inverse problem solvers, 
            owing to their high quality reconstructions and the ability to capture the degeneracy of the posterior distribution. 
            However, most works focus on solving simple linear inverse problems in the noiseless settings, 
            which significantly under-represents the complexity of the real world problems. 
          </p>
          <p>
            In this work, we extend diffusion solvers to efficiently handle 
            general noisy inverse problems via the Laplace approximation of the posterior sampling.
            Interestingly, the resulting posterior sampling scheme is a blended version of the diffusion sampling 
            with the manifold constrained gradient without any measurement consistency projection step, 
            yielding more desirable generative path compared to the previous studies.
          </p>
          <p>
            Our method demonstrates that diffusion models are not only capable of 
            solving general noisy (i.e. Gaussian and Poisson measurement noise) linear inverse problems, 
            but also noisy nonlinear inverse problems such as Fourier phase retrieval and non-uniform deblurring.            
          </p>
        </div>
      </div>
    </div>
    <!--/ Abstract. -->

    <!-- Paper video. -->
    <!-- <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Video</h2>
        <div class="publication-video">
          <iframe src="https://www.youtube.com/embed/MrKrnHhk8IA?rel=0&amp;showinfo=0"
                  frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>
        </div>
      </div>
    </div> -->
    <!--/ Paper video. -->
  </div>
</section>


<section class="section">
  <div class="container is-max-desktop">
    <h2 class="title is-2">Linear Inverse Problem</h2>
    <div class="">
      <div class="btns">
        <button class="button 
        button--ujarak 
        button--border-medium 
        button--round-s 
        button--text-thick" id="superres">SR</button>
        <button class="button 
        button--ujarak 
        button--border-medium 
        button--round-s 
        button--text-thick"id="inpaint">Inpaint</button>
        <button class="button 
        button--ujarak 
        button--border-medium 
        button--round-s 
        button--text-thick"id="deblur">Deblur</button>
      </div>
      <div id="description" class="description hero is-light">
        <p style="font-size: 1.5rem;">
          $$y=L^f x + n$$
        </p>
        <p>where $$L^f$$ denotes the bicubic downsampling block Hankel matrix with the factor $$f$$.</p>
      </div>
      <div class="display-1">
        <h2 class="display-title">Super-resolution x4</h2>
        <div id="results-carousel linear" class="carousel results-carousel">
          <div id="display-1-item-1" class="item">
            <img-comparison-slider>
              <img slot="first" src="static/images/results/deblur/motion/input/00000.png" />
              <img slot="second" src="static/images/results/deblur/motion/recon/00000.png" />
            </img-comparison-slider>
          </div>
          
          <div id="display-1-item-2" class="item">
            <img-comparison-slider>
              <img slot="first" src="static/images/results/deblur/motion/input/00003.png" />
              <img slot="second" src="static/images/results/deblur/motion/recon/00003.png" />
            </img-comparison-slider>
          </div>
          
          <div id="display-1-item-3" class="item">
            <img-comparison-slider>
              <img slot="first" src="static/images/results/deblur/motion/input/00004.png" />
              <img slot="second" src="static/images/results/deblur/motion/recon/00004.png" />
            </img-comparison-slider>
          </div>
          
          <div id="display-1-item-4" class="item">
            <img-comparison-slider>
              <img slot="first" src="static/images/results/deblur/motion/input/00005.png" />
              <img slot="second" src="static/images/results/deblur/motion/recon/00005.png" />
          </img-comparison-slider>
          </div>
          
          <div id="display-1-item-5" class="item">
            <img-comparison-slider>
              <img slot="first" src="static/images/results/deblur/motion/input/00006.png" />
              <img slot="second" src="static/images/results/deblur/motion/recon/00006.png" />
            </img-comparison-slider>
          </div>

          <div id="display-1-item-6" class="item">
            <img-comparison-slider>
              <img slot="first" src="static/images/results/deblur/motion/input/00001.png" />
              <img slot="second" src="static/images/results/deblur/motion/recon/00001.png" />
            </img-comparison-slider>
          </div>
        </div> 
      </div>
      <div class="display-2">
        <h2 class="display-title">Super-resolution x16</h2>
        <div id="results-carousel linear" class="carousel results-carousel">
          <div id="display-2-item-1" class="item">
            <img-comparison-slider>
              <img slot="first" src="static/images/results/deblur/motion/input/00000.png" />
              <img slot="second" src="static/images/results/deblur/motion/recon/00000.png" />
            </img-comparison-slider>
          </div>
          
          <div id="display-2-item-2" class="item">
            <img-comparison-slider>
              <img slot="first" src="static/images/results/deblur/motion/input/00003.png" />
              <img slot="second" src="static/images/results/deblur/motion/recon/00003.png" />
            </img-comparison-slider>
          </div>
          
          <div id="display-2-item-3" class="item">
            <img-comparison-slider>
              <img slot="first" src="static/images/results/deblur/motion/input/00004.png" />
              <img slot="second" src="static/images/results/deblur/motion/recon/00004.png" />
            </img-comparison-slider>
          </div>
          
          <div id="display-2-item-4" class="item">
            <img-comparison-slider>
              <img slot="first" src="static/images/results/deblur/motion/input/00005.png" />
              <img slot="second" src="static/images/results/deblur/motion/recon/00005.png" />
          </img-comparison-slider>
          </div>
          
          <div id="display-2-item-5" class="item">
            <img-comparison-slider>
              <img slot="first" src="static/images/results/deblur/motion/input/00006.png" />
              <img slot="second" src="static/images/results/deblur/motion/recon/00006.png" />
            </img-comparison-slider>
          </div>

          <div id="display-2-item-6" class="item">
            <img-comparison-slider>
              <img slot="first" src="static/images/results/deblur/motion/input/00001.png" />
              <img slot="second" src="static/images/results/deblur/motion/recon/00001.png" />
            </img-comparison-slider>
          </div>
        </div> 
      </div>

    </div>
  </div>
</section>


<section class="section">
  <div class="container is-max-desktop">
    <h2 class="title is-2">Non-linear Inverse Problem</h2>
      <div class="columns is-centered">
        <div class="column">
          <div class="content">
            <h2 class="title is-4">Nonlinear deblurring</h2>
            <p style="text-align: center; font-size: 1.5rem;">
              $$y=\int {b \left(\frac{1}{M} \sum_{i=1}^{M} x[i]\right)}$$
            </p>
            <p>where $$b(x)=x^{1/2.2}$$ is the nonlinear camera response function.</p>
            <video id="dollyzoom" autoplay controls muted loop playsinline height="100%">
              <source src="https://homes.cs.washington.edu/~kpar/nerfies/videos/dollyzoom-stacked.mp4"
                      type="video/mp4">
            </video>
          </div>
        </div>
        <div class="column">
          <h2 class="title is-4">Phase retrieval</h2>
          <div class="columns is-centered">
            <div class="column content">
              <p style="text-align: center; font-size: 1.5rem;">
                $$y=|FPx|+n$$
              </p>
              <p>
                where $$F$$ denotes the 2D Discrete Fourier Transform (DFT) 
                and $$P$$ is the oversampling matrix to induce the uniqueness condition.
              </p>
              <video id="matting-video" controls playsinline height="100%">
                <source src="https://homes.cs.washington.edu/~kpar/nerfies/videos/matting.mp4"
                        type="video/mp4">
              </video>
            </div>
          </div>
        </div>
      </div>
    </div>
</section>
  

<section class="section">
  <div class="container is-max-desktop content">
    <h2 class="title is-2">Poisson measurement noise</h2>
    <img alt="blank image">
  </div>
</section>


<!-- <section class="section">
    <div class="columns is-centered">
      <div class="column is-full-width">
        <h2 class="title is-3">Animation</h2>

        <h3 class="title is-4">Interpolating states</h3>
        <div class="content has-text-justified">
          <p>
            We can also animate the scene by interpolating the deformation latent codes of two input
            frames. Use the slider here to linearly interpolate between the left frame and the right
            frame.
          </p>
        </div>
        <div class="columns is-vcentered interpolation-panel">
          <div class="column is-3 has-text-centered">
            <img src="https://homes.cs.washington.edu/~kpar/nerfies/images/interpolate_start.jpg"
                 class="interpolation-image"
                 alt="Interpolate start reference image."/>
            <p>Start Frame</p>
          </div>
          <div class="column interpolation-video-column">
            <div id="interpolation-image-wrapper">
              Loading...
            </div>
            <input class="slider is-fullwidth is-large is-info"
                   id="interpolation-slider"
                   step="1" min="0" max="100" value="0" type="range">
          </div>
          <div class="column is-3 has-text-centered">
            <img src="https://homes.cs.washington.edu/~kpar/nerfies/images/interpolate_end.jpg"
                 class="interpolation-image"
                 alt="Interpolation end reference image."/>
            <p class="is-bold">End Frame</p>
          </div>
        </div>
        <br/>

        <h3 class="title is-4">Re-rendering the input video</h3>
        <div class="content has-text-justified">
          <p>
            Using <span class="dnerf">Nerfies</span>, you can re-render a video from a novel
            viewpoint such as a stabilized camera by playing back the training deformations.
          </p>
        </div>
        <div class="content has-text-centered">
          <video id="replay-video"
                 controls
                 muted
                 preload
                 playsinline
                 width="75%">
            <source src="https://homes.cs.washington.edu/~kpar/nerfies/videos/replay.mp4"
                    type="video/mp4">
          </video>
        </div>

      </div>
    </div>
</section>   -->

<section class="section">
    <!-- Concurrent Work. -->
  <div class="container is-max-desktop content">
    <div class="columns is-centered">
      <div class="column is-full-width">
        <h2 class="title is-3">Related Links</h2>

        <div class="content has-text-justified">
          <p>
            There's a lot of excellent work that was introduced around the same time as ours.
          </p>
          <p>
            <a href="https://arxiv.org/abs/2104.09125">Progressive Encoding for Neural Optimization</a> introduces an idea similar to our windowed position encoding for coarse-to-fine optimization.
          </p>
          <p>
            <a href="https://www.albertpumarola.com/research/D-NeRF/index.html">D-NeRF</a> and <a href="https://gvv.mpi-inf.mpg.de/projects/nonrigid_nerf/">NR-NeRF</a>
            both use deformation fields to model non-rigid scenes.
          </p>
          <p>
            Some works model videos with a NeRF by directly modulating the density, such as <a href="https://video-nerf.github.io/">Video-NeRF</a>, <a href="https://www.cs.cornell.edu/~zl548/NSFF/">NSFF</a>, and <a href="https://neural-3d-video.github.io/">DyNeRF</a>
          </p>
          <p>
            There are probably many more by the time you are reading this. Check out <a href="https://dellaert.github.io/NeRF/">Frank Dellart's survey on recent NeRF papers</a>, and <a href="https://github.com/yenchenlin/awesome-NeRF">Yen-Chen Lin's curated list of NeRF papers</a>.
          </p>
        </div>
      </div>
    </div>
  </div>
    <!--/ Concurrent Work. -->
</section>


<section class="section" id="BibTeX">
  <div class="container is-max-desktop content">
    <h2 class="title">BibTeX</h2>
    <pre><code>@article{park2021nerfies,
  author    = {Park, Keunhong and Sinha, Utkarsh and Barron, Jonathan T. and Bouaziz, Sofien and Goldman, Dan B and Seitz, Steven M. and Martin-Brualla, Ricardo},
  title     = {Nerfies: Deformable Neural Radiance Fields},
  journal   = {ICCV},
  year      = {2021},
}</code></pre>
  </div>
</section>


<footer class="footer">
  <div class="container">
    <div class="content has-text-centered">
      <a class="icon-link"
         href="https://homes.cs.washington.edu/~kpar/nerfies/videos/nerfies_paper.pdf">
        <i class="fas fa-file-pdf"></i>
      </a>
      <a class="icon-link" href="https://github.com/keunhong" class="external-link" disabled>
        <i class="fab fa-github"></i>
      </a>
    </div>
    <div class="columns is-centered">
      <div class="column is-8">
        <div class="content">
          <p>
            This website is licensed under a <a rel="license"
                                                href="http://creativecommons.org/licenses/by-sa/4.0/">Creative
            Commons Attribution-ShareAlike 4.0 International License</a>.
          </p>
          <p>
            This means you are free to borrow the <a
              href="https://github.com/nerfies/nerfies.github.io">source code</a> of this website,
            we just ask that you link back to this page in the footer.
            Please remember to remove the analytics code included in the header of the website which
            you do not want on your website.
          </p>
        </div>
      </div>
    </div>
  </div>
</footer>

</body>
</html>
